dag:
  dag_id: mini-tapad-pipeline
  schedule_interval: '0 0 * * 0' # Runs every week
  start_date: "2021-08-05T00:00:00"
  max_active_runs: 1
  catchup: False
  default_args:
    owner: airflow
steps:
  - name: mini-tapad-loader
    type: base-kube
    depends_on: []
    cmds: 
      - "node"
    image: "105618632367.dkr.ecr.us-east-1.amazonaws.com/nodejobs:latest"
    arguments:
      - "dist/jobs/mini-tapad-loader/index.js"
    env_vars:
      - name: SNOWFLAKE_DATABASE
        value: DATA_COLLECTION_DB_STAGE
      - name: SNOWFLAKE_SCHEMA
        value: IDENTITIES
    secrets:
      - env: SNOWFLAKE_ACCOUNT
        name: snowflake
        key: snowflakeAccount
      - env: SNOWFLAKE_USERNAME
        name: snowflake
        key: snowflakeUsername
      - env: SNOWFLAKE_PASSWORD
        name: snowflake
        key: snowflakePassword
